\documentclass[12pt,A4]{extarticle}	

\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx,wrapfig,lipsum}
\usepackage[german]{babel}

\newcommand{\lectureTitle}{Authentisierung und Verschlüsselung [WIP]}
\newcommand{\semester}{Sommersemester 2023}

\newcommand{\titleSize}{\LARGE}

\input{../shared/summary-boilerplate.tex}
\cfoot{\thepage\ $/$ \pageref*{LastPage}}

\definecolor{highlightColor}{RGB}{66, 135, 245}
\newcommand{\highlight}[1]{\textcolor{highlightColor}{\textbf{#1}}}

\def\contentsname{\empty}
\addto\captionsgerman{
  \renewcommand{\contentsname}{\empty}
}

\begin{document}

\disclaimer

\tableofcontents
\clearpage

\section{Einführung}
\subsection{Ziel von Kryptographischen Verfahren}
Kryptographische Verfahren sollen \highlight{Authentizität} (Dokument wurde von einer bestimmten Person signiert) und \highlight{Integrität} (Dokument wurde nicht verändert) sicherstellen.

\subsection{Informelle Definition von Signaturen}
\begin{itemize}
  \item{\textbf{asymmetrische} Verfahren}
  \item{Schlüsselpaar $(pk, sk)$}
  \item{Nachricht $m$ wird mit $sk$ signiert und erzeugt Signatur $\sigma$}
  \item{Mit $pk$ kann überprüft werden, ob eine Signatur $\sigma$ gültig für eine Nachricht $m$ ist}
\end{itemize}

\subsection{Digitale Signaturen}
\subsubsection{Definition}
Ein digitales Signaturverfahren für einen Nachrichtenraum $\mathcal{M}$ ist ein Tupel $\Sigma = (Gen, Sign, Vfy)$ von probabilistischen Polyzeit (PPT) Algorithmen:
\begin{itemize}
  \item{$Gen(1^k) \rightarrow (pk, sk)$}
  \item{$Sign(sk, m) \rightarrow \sigma$, $m \in \mathcal{M}$}
  \item{$Vfy(pk, m, \sigma) \in \{0, 1\}$}
\end{itemize}

\subsubsection{Correctness}
\highlight{Correctness} (``Das Verfahren funktioniert''): $\forall (pk, sk) \leftarrow Gen(1^k) \forall m \in \mathcal{M}: Vfy(pk, m, Sign(sk, m)) = 1$

\subsection{Sicherheitsdefinitionen}
Sicherheit besteht aus einem \highlight{Angreifermodell} (was kann der Angreifer tun, welche Angriffsmöglichkeiten stehen zur Verfügung) und einem \highlight{Angreiferziel} (was muss der Angreifer tun, um das Verfahren zu brechen).

\subsubsection{Angreifermodelle}
\begin{enumerate}
  \item{no-message attack (NMA)
              \begin{itemize}
                \item{Angreifer erhält nur $pk$}
              \end{itemize}
        }
  \item{\highlight{non-adaptive chosen-message attack (naCMA)}
              \begin{itemize}
                \item{Angreifer wählt $m_1, \dots, m_q$}
                \item{Angreifer erhält \textbf{danach} $pk$ und Signaturen $\sigma_1, \dots, \sigma_q$}
              \end{itemize}
        }
  \item{\highlight{(adaptive) chosen-message attack (CMA)}
              \begin{itemize}
                \item{Angreifer erhält $pk$}
                \item{Angreifer wählt dann (adaptiv) $m_1, \dots, m_q$ und erhält Signaturen $\sigma_1, \dots, \sigma_q$}
                \item{Adaptiv: Angreifer darf Wahl von $m_i$ abhängig von vorherigen $\sigma_j$ ($j < i$) und $pk$ machen}
              \end{itemize}
        }
\end{enumerate}

\subsubsection{Angreiferziele}
\begin{enumerate}
  \item{Universal Unforgeability (UUF)
              \begin{itemize}
                \item{Nachricht $m$ wird zufällig gewählt}
                \item{Angreifer muss $m$ signieren}
              \end{itemize}
        }
  \item{\highlight{Existential Unforgeablility (EUF)}
              \begin{itemize}
                \item{Angreifer kann Nachricht $m$ beliebig wählen und diese signieren}
              \end{itemize}
        }
\end{enumerate}

In den \textbf{Sicherheitsdefinitionen} werden \textbf{Angreiferziel} und \textbf{Angreifermodell} kombiniert, z.B.
\begin{itemize}
  \item{EUF-CMA}
  \item{EUF-naCMA}
\end{itemize}

\subsection{EUF-CMA-Sicherheitsexperiment}
Bei Sicherheitsexperimenten spielt ein Angreifer $\mathcal{A}$ gegen einen Challenger $\mathcal{C}$. $\mathcal{A}$ gewinnt, falls er die Sicherheit des Verfahrens bricht.\par
$\mathcal{A}$ muss dabei mit einer nicht vernachlässigbaren Wahrscheinlichkeit eine gültige Signatur erzeugen können, ohne den Schlüssel $sk$ zu kennen.

\subsubsection{Visualisierung: EUF-CMA-Sicherheitsexperiment}
\begin{tikzpicture}
  \node (A) at (0,6) {$\mathcal{C}_\text{EUF-CMA}$};
  \node (B) at (5,6) {$\mathcal{A}$};
  \node[label={[align=center]below:$Vfy(pk, m^*, \sigma^*) = 1$?\\ $\land$ \\ $m^* \notin \{m_1, \dots, m_q\}$?}] (C) at (0,0) {};
  \node (D) at (5,0) {};

  \draw[dashed] (A) -- (C);
  \draw[dashed] (B) -- (D);

  \node[label={left:$(pk, sk) \leftarrow Gen(1^k)$}] at (0,5) {};
  \node[label={left:$\sigma_i \leftarrow Sign(sk, m_i)$}]  at (0,3) {};

  \draw[decoration={calligraphic brace,amplitude=10pt}, decorate, line width=1.25pt] (5.2,4) -- (5.2,2)
  node[midway, right=0pt, font=\footnotesize] {\begin{minipage}{5cm}\begin{itemize}
        \item{Anfragen nacheinander}
        \item{$q = q(k)$ Anfragen}
        \item{$q$ Polynom}
      \end{itemize}\end{minipage}};

  \draw[->,shorten >=5pt, shorten <=5pt] (0,5) -- (5,4.5) node[midway, above, sloped] {$pk$};
  \draw[->,shorten >=5pt, shorten <=5pt] (5,4) -- (0,3.5) node[midway, above, sloped] {$m_i$};

  \draw[->,shorten >=5pt, shorten <=5pt] (0,2.5) -- (5,2) node[midway, above, sloped] {$\sigma_i$};
  \draw[->,shorten >=5pt, shorten <=5pt] (5,1.5) -- (0,1) node[midway, above, sloped] {$m^*, \sigma^*$};
\end{tikzpicture}

$\mathcal{A}$ gewinnt, falls $Vfy(pk, m^*, \sigma^*) = 1$ \textbf{und} $m^* \notin \{m_1, \dots, m_q\}$

\subsubsection{Definition: Vernachlässigbarkeit}
Eine Funktion $negl: \mathbb{N} \rightarrow [0, 1]$ ist \textit{vernachlässigbar}, wenn
\begin{flalign*}
  \forall c \in \mathbb{N} \exists k_0 \in \mathbb{N} \forall k \geq k_0: negl(k) < \frac{1}{k^c}
\end{flalign*}

\subsubsection{Definition: EUF-CMA}\label{sec:DefinitionEUFCMA}
Ein digitales Signaturverfahren $\Sigma = (Gen, Sign, Vfy)$ ist \textit{EUF-CMA-sicher}, wenn für alle PPT $\mathcal{A}$ gilt, dass
\begin{flalign*}
   & \Pr[\mathcal{A} \text{ gewinnt EUF-CMA-Experiment}]                                                                                    \\
   & = \Pr[\mathcal{A}^{\mathcal{C}_\text{EUF-CMA}}(pk) = (m^*, \sigma^*): Vfy(pk, m^*, \sigma^*) = 1 \land m^* \notin \{m_1, \dots, m_q\}] \\
   & \leq negl(k)
\end{flalign*}
für eine im Sicherheitsparameter $k$ vernachlässigbare Funktion $negl$.

\subsection{EUF-naCMA-Sicherheitsexperiment}
\subsubsection{Visualisierung: EUF-naCMA-Sicherheitsexperiment}
\begin{tikzpicture}
  \node (A) at (0,5) {$\mathcal{C}_\text{EUF-naCMA}$};
  \node (B) at (5,5) {$\mathcal{A}$};
  \node[label={[align=center]below:$Vfy(pk, m^*, \sigma^*) = 1$?\\ $\land$ \\ $m^* \notin \{m_1, \dots, m_q\}$?}] (C) at (0,0) {};
  \node (D) at (5,0) {};

  \draw[dashed] (A) -- (C);
  \draw[dashed] (B) -- (D);

  \node[label={right:\begin{minipage}{5cm}\footnotesize\begin{itemize}
            \item{$q = q(k)$ Nachrichten}
            \item{$q$ Polynom}
          \end{itemize}\end{minipage}}] at (5,4) {};
  \node[label={[align=left]left:$(pk, sk) \leftarrow Gen(1^k)$\\$\forall i: \sigma_i \leftarrow Sign(sk, m_i)$}] at (0,3) {};

  \draw[->,shorten >=5pt, shorten <=5pt] (5,4) -- (0,3.5) node[midway, above, sloped] {$m_1, \dots, m_q$};

  \draw[->,shorten >=5pt, shorten <=5pt] (0,2.5) -- (5,2) node[midway, above, sloped] {$pk, \sigma_1, \dots, \sigma_q$};
  \draw[->,shorten >=5pt, shorten <=5pt] (5,1.5) -- (0,1) node[midway, above, sloped] {$m^*, \sigma^*$};
\end{tikzpicture}

$\mathcal{A}$ gewinnt, falls $Vfy(pk, m^*, \sigma^*) = 1$ \textbf{und} $m^* \notin \{m_1, \dots, m_q\}$


\subsubsection{Definition: EUF-naCMA}
Ein digitales Signaturverfahren $\Sigma = (Gen, Sign, Vfy)$ ist \textit{EUF-naCMA-sicher}, wenn für alle PPT $\mathcal{A}$ gilt, dass
\begin{flalign*}
   & \Pr[\mathcal{A} \text{ gewinnt EUF-naCMA-Experiment}]                                                                                \\
   & = \Pr[\mathcal{A}^{\mathcal{C}_\text{EUF-naCMA}} = (m^*, \sigma^*): Vfy(pk, m^*, \sigma^*) = 1 \land m^* \notin \{m_1, \dots, m_q\}] \\
   & \leq negl(k)
\end{flalign*}
für eine im Sicherheitsparameter $k$ vernachlässigbare Funktion $negl$.

\subsection{Einmalsignaturen}
\begin{itemize}
  \item{Ziel: Signaturen, die viele Nachrichten signieren können}
  \item{Vorstufe: Signaturen, die nur \textbf{eine} Nachricht \textbf{sicher} signieren können (\highlight{Einmalsignaturen})}
  \item{für jeden \textit{public key} sollte nur eine einzige Signatur ausgestellt werden, sonst evtl. unsicher}
\end{itemize}

\subsubsection{Sicherheitsbegriffe für Einmalsignaturen}
Analog zum vorherigen Kapitel definieren wir \textbf{EUF-1-CMA} und \textbf{EUF-1-naCMA} für Einmalsignaturen.

\subsubsection{Beziehungen zwischen Sicherheitsdefinitionen}
\begin{tikzpicture}
  \node at (0,0) {EUF-1-naCMA};
  \node at (2,0) {$\Leftarrow$};
  \node at (4,0) {EUF-1-CMA};

  \node at (0,1) {$\Downarrow$};
  \node at (4,1) {$\Downarrow$};

  \node at (0,2) {EUF-naCMA};
  \node at (2,2) {$\Leftarrow$};
  \node at (4,2) {EUF-CMA};
\end{tikzpicture}

Beweis im Skript.

\subsection{Perfekte Sicherheit}
In den Definitionen, z.B. bei \hyperref[sec:DefinitionEUFCMA]{EUF-CMA} finden sich zwei Einschränkungen, die im folgenden erläutert werden:

\subsubsection{Warum müssen wir uns auf PPT-Angreifer beschränken?}
Durch Brute-Force könnte ein unbeschränkter Angreifer alle Signaturen durchprobieren und so valide Signaturen für beliebige Nachrichten finden, wodurch er beim Sicherheitsexperiment immer gewinnen würde.

\subsubsection{Warum muss die Erfolgswahrscheinlichkeit des Angreifers nur vernachlässigbar sein?}
Die Erfolgswahrscheinlichkeit kann nicht 0 sein, da der Angreifer durch zufälliges Raten eine gültige Signatur für eine beliebige Nachricht finden könnte, wodurch er das Sicherheitsexperiment gewinnt.

\subsection{Erweiterung des Nachrichtenraumes}
Wir konstruieren fast immer Signaturen mit ``kleinem'' Nachrichtenraum, z.B.
\begin{itemize}
  \item{$\mathbb{Z}_p = \{0, \dots, p-1\}$, $p$ prim}
  \item{$\{0, 1\}^{q(k)}$, $q$ Polynom, $k$ Sicherheitsparameter}
\end{itemize}
Unser Ziel ist es jedoch, beliebige Nachrichten, z.B. $\{0, 1\}^*$, zu signieren.

\subsubsection{Hashfunktionen}
Eine kryptographische Hashfunktion $H = (Gen_H, Eval_H)$ ist ein Tupel aus zwei PPT-Algorithmen:
\begin{itemize}
  \item{$Gen_H(1^k)$ berechnet $t$, sodass $t$ eine Funktion
              \begin{flalign*}
                H_t: \{0, 1\}^* \rightarrow \mathcal{M}_t
              \end{flalign*}
              spezifiziert}
  \item{$Eval_H(1^k, t,x)$ berechnet $H_t(x)$}
\end{itemize}

\subsubsection{Kollisionsresistenz}
Eine Hashfunktion $H = (Gen_H, Eval_H)$ ist \highlight{kollisionsresistent}, falls für alle $t \leftarrow Gen_H(1^k)$ und für alle PPT $\mathcal{A}$ gilt, dass
\begin{flalign*}
  \Pr[\mathcal{A}(1^k, t) = (x, x'): H_t(x) = H_t(x') \land x \neq x'] \leq negl(k)
\end{flalign*}
für eine im Sicherheitsparameter $k$ vernachlässigbare Funktion $negl$.

\subsubsection{Signatur mit unbeschränktem Nachrichtenraum (\highlight{Hash-then-Sign})}
Wir wollen nun Signaturen mit unbeschränktem Nachrichtenraum konstruieren. Gegeben:
\begin{itemize}
  \item{$\Sigma' = (Gen', Sign', Vfy')$ mit Nachrichtenraum $\mathcal{M}$}
  \item{kollisionsresistente Hashfunktion $H: \{0,1\}^* \rightarrow \mathcal{M}$}
\end{itemize}
Konstruiere $\Sigma = (Gen, Sign, Vfy)$ mit Nachrichtenraum $\{0,1\}^*$:
\begin{itemize}
  \item{$Gen(1^k)$ berechnet $(pk, sk) \leftarrow Gen'(1^k)$}
  \item{$Sign(sk, m)$ berechnet $\sigma \leftarrow Sign'(sk, H(m))$}
  \item{$Vfy(pk, m, \sigma)$ gibt $Vfy'(pk, H(m), \sigma)$ aus}
\end{itemize}

\section{q-mal Signaturen}
\subsection{Von EUF-naCMA-Sicherheit zu EUF-CMA-Sicherheit}
Gegeben
\begin{itemize}
  \item{ein EUF-naCMA-sicheres Signaturverfahren $\Sigma'$ und}
  \item{ein EUF-1-naCMA-sicheres Einmalsignaturverfahren $\Sigma^{(1)}$}
\end{itemize}
können wir mittels \textbf{Transformation} ein \textbf{EUF-CMA}-sicheres Signaturverfahren $\Sigma$ konstruieren.

\subsubsection{Transformation}
Gegeben:
\begin{itemize}
  \item{EUF-naCMA-sicheres Signaturverfahren $\Sigma' = (Gen', Sign', Vfy')$}
  \item{EUF-1-naCMA-sicheres Signaturverfahren $\Sigma^{(1)} = (Gen^{(1)}, Sign^{(1)}, Vfy^{(1)})$}
\end{itemize}
Konstruiere nun $\Sigma = (Gen, Sign, Vfy)$ wie folgt:
\begin{itemize}
  \item{$Gen(1^k)$: \begin{flalign*}
                (pk, sk) \coloneqq (pk', sk') \leftarrow Gen'(1^k)
              \end{flalign*} }
  \item{$Sign(sk,m)$: \begin{flalign*}
                (pk^{(1)}, sk^{(1)}) & \leftarrow Gen^{(1)}(1^k)                   \\
                \sigma'              & \leftarrow Sign'(sk, pk^{(1)})              \\
                \sigma^{(1)}         & \leftarrow Sign^{(1)} (sk^{(1)} , m)        \\
                \sigma               & \coloneqq (pk^{(1)}, \sigma^{(1)}, \sigma') \\
              \end{flalign*} }
  \item{$Vfy(pk, m, \sigma)$ gibt 1 aus, wenn\begin{flalign*}
                Vfy'(pk, pk^{(1)}, \sigma') = 1 \land Vfy^{(1)}(pk^{(1)}, m, \sigma^{(1)}) = 1
              \end{flalign*}
              sonst 0 }
\end{itemize}
Es wird also für jede Signatur ein neues Einmalschlüsselpaar erzeugt.

\subsection{Mehrmal-Signaturverfahren aus Einmalsignaturverfahren}
Einmalsignaturverfahren sind effizient und einfach zu konstruieren, daher würden wir gerne eine Variation dieser verwenden, um mehrfach signieren zu können (q-mal-Signaturverfahren).

\subsubsection{Naiver Ansatz: q Schlüsselpaare}
Der naive Ansatz ist, $q$ Schlüsselpaare zu verwenden und einen Zähler $st \in \{1, \dots, q\}$ als Zustand zu verwenden, der auch im Secret Key und in der Signatur vorkommt:
\begin{itemize}
  \item{$Gen(1^k)$: \begin{flalign*}
                 & (pk_i, sk_i) \leftarrow Gen^{(1)}(1^k) \text{ für alle } i \in \{1, \dots, q\} \\
                 & pk \coloneqq (pk_1, \dots, pk_q)                                               \\
                 & sk \coloneqq (sk_1, \dots, sk_q, st = 1)
              \end{flalign*} }
  \item{$Sign(sk,m)$: \begin{flalign*}
                i        & \coloneqq st                   \\
                \sigma_i & \leftarrow Sign^{(1)}(sk_i, m) \\
                \sigma   & \leftarrow (\sigma_i, i)       \\
                st       & \coloneqq st + 1               \\
              \end{flalign*} }
  \item{$Vfy(pk, m, \sigma = (\sigma_i, i))$: \begin{flalign*}
                Vfy^{(1)}(pk_i, m, \sigma_i) \stackrel{?}{=} 1
              \end{flalign*}
        }
\end{itemize}

\underline{\textbf{Eigenschaften bezogen auf Signaturanzahl (q):}}
\begin{itemize}
  \item{$|pk| \in \Theta(q)$}
  \item{$|sk| \in \Theta(q)$}
  \item{$|\sigma| \in \Theta(1)$}
\end{itemize}

\end{document}